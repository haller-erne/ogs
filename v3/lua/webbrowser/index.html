
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://haller-erne.github.io/ogs/v3/lua/webbrowser/">
      
      
        <link rel="prev" href="../../getting-started/">
      
      
        <link rel="next" href="../webserver/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.12">
    
    
      
        <title>Web browsers - OGS Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#browser" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="OGS Documentation" class="md-header__button md-logo" aria-label="OGS Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OGS Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Web browsers
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="OGS Documentation" class="md-nav__button md-logo" aria-label="OGS Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    OGS Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Tool configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tool configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/remote-tool/" class="md-nav__link">
        Remote Tool
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          Open Protocol Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Open Protocol Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/openprotocol/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/openprotocol/nexo.md" class="md-nav__link">
        Nexo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/openprotocol/sys350.md" class="md-nav__link">
        CS351/KE350
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/openprotocol/gwk.md" class="md-nav__link">
        GWK Operator+
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Scripting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Scripting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          LUA interfaces
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          LUA interfaces
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Web browsers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Web browsers
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#javascript-hostobjects-bridge" class="md-nav__link">
    JavaScript hostObjects bridge
  </a>
  
    <nav class="md-nav" aria-label="JavaScript hostObjects bridge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-code" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#global-browser-table" class="md-nav__link">
    Global Browser table
  </a>
  
    <nav class="md-nav" aria-label="Global Browser table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#navigate" class="md-nav__link">
    Navigate
  </a>
  
    <nav class="md-nav" aria-label="Navigate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-code_1" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show" class="md-nav__link">
    Show
  </a>
  
    <nav class="md-nav" aria-label="Show">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters_1" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value" class="md-nav__link">
    Return value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-code_2" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hide" class="md-nav__link">
    Hide
  </a>
  
    <nav class="md-nav" aria-label="Hide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters_2" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-code_3" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regmsghandler" class="md-nav__link">
    RegMsgHandler
  </a>
  
    <nav class="md-nav" aria-label="RegMsgHandler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters_3" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-values" class="md-nav__link">
    Return values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-code_4" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execjs_nonblocking" class="md-nav__link">
    ExecJS_nonblocking
  </a>
  
    <nav class="md-nav" aria-label="ExecJS_nonblocking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters_4" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-code_5" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../webserver/" class="md-nav__link">
        Webserver (and REST API)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          LUA helper libraries
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          LUA helper libraries
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../libs/lua-ads/" class="md-nav__link">
        ADS communication (TwinCat, Nexeed, Beckhoff)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../libs/lua-opcua/" class="md-nav__link">
        OpcUA communication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../libs/lua-modbus/" class="md-nav__link">
        Modbus/TCP/UDP communication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../libs/lua-hid/" class="md-nav__link">
        USB HID Devices (Buttons, Arduino, etc.)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#javascript-hostobjects-bridge" class="md-nav__link">
    JavaScript hostObjects bridge
  </a>
  
    <nav class="md-nav" aria-label="JavaScript hostObjects bridge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-code" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#global-browser-table" class="md-nav__link">
    Global Browser table
  </a>
  
    <nav class="md-nav" aria-label="Global Browser table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#navigate" class="md-nav__link">
    Navigate
  </a>
  
    <nav class="md-nav" aria-label="Navigate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-code_1" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show" class="md-nav__link">
    Show
  </a>
  
    <nav class="md-nav" aria-label="Show">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters_1" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-value" class="md-nav__link">
    Return value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-code_2" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hide" class="md-nav__link">
    Hide
  </a>
  
    <nav class="md-nav" aria-label="Hide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters_2" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-code_3" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regmsghandler" class="md-nav__link">
    RegMsgHandler
  </a>
  
    <nav class="md-nav" aria-label="RegMsgHandler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters_3" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#return-values" class="md-nav__link">
    Return values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-code_4" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execjs_nonblocking" class="md-nav__link">
    ExecJS_nonblocking
  </a>
  
    <nav class="md-nav" aria-label="ExecJS_nonblocking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters_4" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-code_5" class="md-nav__link">
    Sample code
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="browser"><a class="toclink" href="#browser">Browser</a></h1>
<h2 id="overview"><a class="toclink" href="#overview">Overview</a></h2>
<p>The OGS runtime uses up to 4 web browser (Microsoft WebView2) instances. The instances are:</p>
<ul>
<li><code>StartView</code>: Browser on the start screen</li>
<li><code>ProcessView</code>: Browser on the process screen (only visible, if the <code>url</code>-parameter in the job/task is set)</li>
<li><code>SidePanel</code>: Browser on the slide-in side panel (requires enabling the sidepanel in <code>station.ini</code>)</li>
<li><code>InstructionView</code>: Browser in the instruction view popup (is triggered from LUA, so only visible with custom LUA code)</li>
</ul>
<p>The OGS infrastructure provides functions to bidirectionally exchange data between the JavaScript code running inside the web browser and the LUA code running inside OGS. There is a LUA function to execute JavaScript code in the webbrowser and a JavaScript bride, which calls a LUA function (if registered accordingly).</p>
<p>To implement this functionality, OGS provides the following:</p>
<ul>
<li>For the JavaScript side: a bridge implementation accessibal through the <code>hostObjects</code> interface of the Chromium browser (<code>window.chrome.webview.hostObjects.sync.OGS</code>)</li>
<li>For the LUA side: a global <code>Browser</code> table with functions to manipulate the browser instances</li>
</ul>
<h2 id="javascript-hostobjects-bridge"><a class="toclink" href="#javascript-hostobjects-bridge">JavaScript hostObjects bridge</a></h2>
<p>OGS registers a <a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.web.webview2.core.corewebview2.addhostobjecttoscript">hostObject</a> in the WebView2 browser for the JavaScript side. The registered object is named <code>OGS</code> and implements a single string property <code>ObjectMessage</code>.</p>
<p>To send a string to OGS from JavaScript, simply assign a value to the <code>window.chrome.webview.hostObjects.sync.OGS.ObjectMessage</code> property.</p>
<h4 id="sample-code"><a class="toclink" href="#sample-code">Sample code</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// send a command string to OGS </span>
<span class="kd">function</span><span class="w"> </span><span class="nx">sendOgsCommand</span><span class="p">(</span><span class="nx">cmd</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">window</span><span class="p">.</span><span class="nx">chrome</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nb">window</span><span class="p">.</span><span class="nx">chrome</span><span class="p">.</span><span class="nx">webview</span>
<span class="w">     </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nb">window</span><span class="p">.</span><span class="nx">chrome</span><span class="p">.</span><span class="nx">webview</span><span class="p">.</span><span class="nx">hostObjects</span>
<span class="w">     </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nb">window</span><span class="p">.</span><span class="nx">chrome</span><span class="p">.</span><span class="nx">webview</span><span class="p">.</span><span class="nx">hostObjects</span><span class="p">.</span><span class="nx">sync</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// WebView2 is not yet fully initialized</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span><span class="w">     </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">ogs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">chrome</span><span class="p">.</span><span class="nx">webview</span><span class="p">.</span><span class="nx">hostObjects</span><span class="p">.</span><span class="nx">sync</span><span class="p">.</span><span class="nx">OGS</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">ogs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">ogs</span><span class="p">.</span><span class="nx">ObjectMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cmd</span><span class="p">;</span><span class="w">    </span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="global-browser-table"><a class="toclink" href="#global-browser-table">Global Browser table</a></h2>
<p>OGS exposes the browser instances through the global <code>Browser</code> object. The <code>Browser</code> object implements the following functions:</p>
<ul>
<li><a href="#navigate">Navigate</a>: Load a new URL in the web browser</li>
<li><a href="#execjs-nonblocking">ExecJS_nonblocking</a>: Run javascript inside the web browser (asynchronously, not returning a value)</li>
<li><a href="#reg.msg-handler">RegMsgHandler</a>: Register a LUA callback function to be called when the JavaScript side writes to the object message endpoint.</li>
</ul>
<!--
The following functions are also available, but are not fully implemented at the moment:
- [ExecJS_sync](#execjs-sync): 
- [ExecJS_async](#execjs-async):
- [Show](#show): 
- [Hide](#hide): 
- [GetState](#getstate): 
-->

<h3 id="navigate"><a class="toclink" href="#navigate">Navigate</a></h3>
<p>The <code>Browser.Navigate</code> function starts loading a new URL into the given browser instance.</p>
<div class="highlight"><pre><span></span><code><span class="n">Browser</span><span class="p">.</span><span class="n">Navigate</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
</code></pre></div>
<h4 id="parameters"><a class="toclink" href="#parameters">Parameters</a></h4>
<ul>
<li>instance [string]: Web browser instance name (one of 'StartView', 'ProcessView', 'SidePanel', 'InstructionView') </li>
<li>url [string]: Url to navigate the browser instance to (in the standard URL format, e.g. file://filename or https://server/page)</li>
</ul>
<h4 id="sample-code_1"><a class="toclink" href="#sample-code_1">Sample code</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- Navigate the StartView browser to https://www.my-url.com/mypage</span>
<span class="n">Browser</span><span class="p">.</span><span class="n">Navigate</span><span class="p">(</span><span class="s1">&#39;StartView&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.my-url.com/mypage&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="show"><a class="toclink" href="#show">Show</a></h3>
<p>The <code>Browser.Show</code> function is similar to the <code>Browser.Navigate</code> function, but also ensures the webbrowser is actually visible. The actual behaviour depends on the view - e.g. for the <code>SidePanel</code> view, the side panel pops out. For the <code>ProcessView</code> view, this switches from the image-view to the web view.</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">oldUrl</span> <span class="o">=</span> <span class="n">Browser</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
</code></pre></div>
<h4 id="parameters_1"><a class="toclink" href="#parameters_1">Parameters</a></h4>
<ul>
<li>instance [string]: Web browser instance name (one of 'StartView', 'ProcessView', 'SidePanel', 'InstructionView') </li>
<li>url [string]: Url to navigate the browser instance to (in the standard URL format, e.g. file://filename or https://server/page)</li>
</ul>
<h4 id="return-value"><a class="toclink" href="#return-value">Return value</a></h4>
<p>The function returns the "current" URL of the webbrowser (the URL before changing to the given one). This can be used to return to the previous URL after hiding the browser.</p>
<h4 id="sample-code_2"><a class="toclink" href="#sample-code_2">Sample code</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- Make the SidePanel visible and navigate the web browser to https://www.my-url.com/mypage</span>
<span class="kd">local</span> <span class="n">oldUrl</span> <span class="o">=</span> <span class="n">Browser</span><span class="p">.</span><span class="n">Show</span><span class="p">(</span><span class="s1">&#39;SidePanel&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.my-url.com/mypage&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="hide"><a class="toclink" href="#hide">Hide</a></h3>
<p>The <code>Browser.Hide</code> function is complementary to the <code>Browser.Show</code> function - it closes the browser view (only relevant for <code>SidePanel</code> and <code>ProcessView</code>).</p>
<div class="highlight"><pre><span></span><code><span class="n">Browser</span><span class="p">.</span><span class="n">Hide</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
</code></pre></div>
<h4 id="parameters_2"><a class="toclink" href="#parameters_2">Parameters</a></h4>
<ul>
<li>instance [string]: Web browser instance name (one of 'StartView', 'ProcessView', 'SidePanel', 'InstructionView') </li>
</ul>
<h4 id="sample-code_3"><a class="toclink" href="#sample-code_3">Sample code</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- Hide the SidePanel</span>
<span class="n">Browser</span><span class="p">.</span><span class="n">Hide</span><span class="p">(</span><span class="s1">&#39;SidePanel&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="regmsghandler"><a class="toclink" href="#regmsghandler">RegMsgHandler</a></h3>
<p>The <code>Browser.RegMsgHandler</code> function registers or unregisters a LUA function to be called whenever the JavaScript running in the browser writes a message to the hostObject bridge <code>OGS.ObjectMessage</code> property.</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- Register the callback function</span>
<span class="n">fn</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">Browser</span><span class="p">.</span><span class="n">RegMsgHandler</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">callbackfn</span><span class="p">)</span>
</code></pre></div>
<h4 id="parameters_3"><a class="toclink" href="#parameters_3">Parameters</a></h4>
<ul>
<li>instance [string]: Web browser instance name (one of 'StartView', 'ProcessView', 'SidePanel', 'InstructionView') </li>
<li>callbackfn [function]: LUA function to be called when the JavaScript code writes a string to the <code>OGS.ObjectMessage</code> hostObject. If callbackfn is <code>nil</code>, then the current registration is removed. The callback function has the following signature:<pre><code>callbackfn(instance, objectMessage)
</code></pre>
</li>
</ul>
<p>Where instance [string] is the web browsers instance name (e.g. 'StartView') and objectMessage [string] the text which was written to the <code>OGS.ObjectMessage</code> property of the hostObject bridge from the JavaScript side.</p>
<h4 id="return-values"><a class="toclink" href="#return-values">Return values</a></h4>
<p>If the function was executed successfully, the callbackfn is returned as the first return value. Else nil is returned and the second return value has an error message string (wrong parameters or unknown instance).</p>
<h4 id="sample-code_4"><a class="toclink" href="#sample-code_4">Sample code</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="kr">function</span> <span class="nf">callbackfn</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">objectMessage</span><span class="p">)</span>
    <span class="c1">-- do whatever you want to do here if the javascript </span>
    <span class="c1">-- code writes the OGS.ObjectMessage property</span>
<span class="kr">end</span>

<span class="c1">-- Register a LUA function to be called from the JavaScript side</span>
<span class="n">Browser</span><span class="p">.</span><span class="n">RegMsgHandler</span><span class="p">(</span><span class="s1">&#39;StartView&#39;</span><span class="p">,</span> <span class="n">callbackfn</span><span class="p">)</span>
</code></pre></div>
<h3 id="execjs_nonblocking"><a class="toclink" href="#execjs_nonblocking">ExecJS_nonblocking</a></h3>
<p>The <code>Browser.ExecJS_nonblocking</code> executes JavaScript code in the web browser instance.</p>
<div class="highlight"><pre><span></span><code><span class="n">Browser</span><span class="p">.</span><span class="n">ExecJS_nonblocking</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">jstext</span><span class="p">)</span>
</code></pre></div>
<h4 id="parameters_4"><a class="toclink" href="#parameters_4">Parameters</a></h4>
<ul>
<li>instance [string]: Web browser instance name (one of 'StartView', 'ProcessView', 'SidePanel', 'InstructionView') </li>
<li>jstext [string]: JavaScript string to execute in the browser. Note that this must be valid JavaScript code. </li>
</ul>
<p><strong>NOTES</strong>: </p>
<ul>
<li>When passing strings through the function, make sure to propery escape them!</li>
<li>Best practice is to write a JavaScript function in the web page and only call it through this function.</li>
<li>You can serialize LUA objects to a JSON string and pass this through the function. The JavaScript side can then easily deserialize it.</li>
</ul>
<h4 id="sample-code_5"><a class="toclink" href="#sample-code_5">Sample code</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- Build a JavaScript command, call the function &quot;my_function&quot; with</span>
<span class="c1">-- some JSON text</span>
<span class="kd">local</span> <span class="n">param</span> <span class="o">=</span> <span class="s1">&#39;{ &quot;cmd&quot;: &quot;showmessage&quot; }&#39;</span>
<span class="kd">local</span> <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;my_function(&quot;</span><span class="o">..</span><span class="n">param</span><span class="o">..</span><span class="s2">&quot;);&quot;</span>
<span class="c1">-- Call the JavaScript function in the StartView browser</span>
<span class="n">Browser</span><span class="p">.</span><span class="n">ExecJS_nonblocking</span><span class="p">(</span><span class="s1">&#39;StartView&#39;</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.4b2c34cd.min.js"></script>
      
    
  </body>
</html>