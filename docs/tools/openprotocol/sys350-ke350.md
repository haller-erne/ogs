

# (DRAFT) KE350 MultiSpindle controller


## Overview

System350 based tools mainly fall into two categories:

- Single spindle tools and ErgoSpin tools used in spindle mode
- Multi-spindle tools
- ErgoSpin tools (used in ErgoSpin hand-tool mode) - these are not considered here, as typically a CS351 controller is used in this case, please see [CS351 OpenProtocol](sys350-cs351.md).

Spindle tools (and ErgoSpin in spindle mode) use externally connected start switches (for start CW, start CCW). All tools are controlled over OpenProtocol using the "Ford OpenProtocol" protocol type and are started in application mode (using fasterning operation FO 1).

Additional notes:

- Check the PSet start step parameter setting "play with start switch"
- Check the `CHANNEL_<tool>_CCW_ACK` setting for the tool in `station.ini`.
- See below on how to configure the PLC assignment table for `FO 1 SSWLock` and the external `CCWSel` signals

For the `CHANNEL_<tool>_CCW_ACK` setting, the following is recommended:

- If you use a spindle tool with seperately wired CW/CCW and start signals, then set `CHANNEL_<tool>_CCW_ACK=1` and connect the direction switch output to the `CCWSel`-Signal
- If you use a spindle tool with only CW start and CCW start signals, then set `CHANNEL_<tool>_CCW_ACK=0`, but make sure to configure the `FO 1 CCWLock` signal

!!! note

    To reliably prevent loosen it is recommended to use a seperate direction switch connected to the `CCWSel` signal and also connect the `FO 1 CCWLock`-Signal (see [below](#plc-signal-assignment-for-openprotocol)).

## OpenProtocol configuration

### Overview

OGS uses the KE350 `Rexroth OP-Ford R1.0` protocol version. This maps the
OpenProtool commands to the application start (fastening operation) `FO 1` signals, so multiple spindles can work in a synchronized way and report the spindle groups result status. 

![KE350 OpenProtocol settings](resources/ke350-openprotocol-settings.png){ align=right; width=300 }
/// caption
KE350 OpenProtocol settings
///

